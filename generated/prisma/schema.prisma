// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model AgentExecution {
  id                       String    @id @default(cuid())
  feedId                   Int?
  runStartId               Int?
  invocationId             String?   @unique
  status                   String // 'success' | 'failure'
  errorMessage             String?
  model                    String
  llmCallCount             Int
  inputTokens              Int
  outputTokens             Int
  totalTokens              Int
  cacheCreationInputTokens Int?
  cacheReadInputTokens     Int?
  toolCallsCount           Int
  modifiedFiles            String[]
  startTime                DateTime
  endTime                  DateTime?
  durationMs               Int?
  taskIndex                Int?
  temperature              Float?
  maxTokens                Int?
  reportedCostUsd          Decimal?  @db.Decimal(10, 6)

  createdAt DateTime @default(now())

  @@index([startTime])
  @@index([status])
  @@index([model])
  // Composite indexes for common query patterns
  @@index([startTime, status])
  @@index([startTime, model])
}
